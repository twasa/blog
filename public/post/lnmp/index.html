<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge,chrome=1">
  <title>CentOS7 Linux&#43;Nginx&#43;MariaDB&#43;PHP &middot; William&#39;s Blog -  William&#39;s Blog </title>
  <meta name="generator" content="Hugo 0.26" />
  <meta name="description" content="William&#39;s Blog"> 

  <meta name="twitter:card" content="summary"/><meta name="twitter:title" content="CentOS7 Linux&#43;Nginx&#43;MariaDB&#43;PHP"/>
<meta name="twitter:description" content="Build a Linux, Nginx, MariaDB, PHP environment in CentOS 7 install rpm -Uvh http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm yum install nginx php php-fpm mariadb mariadb-server  firewalld for http, https access only firewall-cmd --zone=public --list-all firewall-cmd --permanent --zone=public --add-service=http firewall-cmd --permanent --zone=public --add-service=https firewall-cmd --reload firewall-cmd --zone=public --list-all  Nginx config basic config, edit /etc/nginx/nginx.conf user nginx; worker_processes 2; #by your cpu error_log /var/log/nginx/error.log warn; pid /var/run/nginx.pid; events { worker_connections 1024; } http { include /etc/nginx/mime."/>

  <meta property="og:title" content="CentOS7 Linux&#43;Nginx&#43;MariaDB&#43;PHP" />
<meta property="og:description" content="Build a Linux, Nginx, MariaDB, PHP environment in CentOS 7 install rpm -Uvh http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm yum install nginx php php-fpm mariadb mariadb-server  firewalld for http, https access only firewall-cmd --zone=public --list-all firewall-cmd --permanent --zone=public --add-service=http firewall-cmd --permanent --zone=public --add-service=https firewall-cmd --reload firewall-cmd --zone=public --list-all  Nginx config basic config, edit /etc/nginx/nginx.conf user nginx; worker_processes 2; #by your cpu error_log /var/log/nginx/error.log warn; pid /var/run/nginx.pid; events { worker_connections 1024; } http { include /etc/nginx/mime." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://twasa.github.io/post/lnmp/" />



<meta property="article:published_time" content="2017-09-11T10:14:51&#43;08:00"/>
<meta property="article:modified_time" content="2017-09-11T10:14:51&#43;08:00"/>












  <!-- RSS autodiscovery --> 

  
<meta itemprop="name" content="CentOS7 Linux&#43;Nginx&#43;MariaDB&#43;PHP">
<meta itemprop="description" content="Build a Linux, Nginx, MariaDB, PHP environment in CentOS 7 install rpm -Uvh http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm yum install nginx php php-fpm mariadb mariadb-server  firewalld for http, https access only firewall-cmd --zone=public --list-all firewall-cmd --permanent --zone=public --add-service=http firewall-cmd --permanent --zone=public --add-service=https firewall-cmd --reload firewall-cmd --zone=public --list-all  Nginx config basic config, edit /etc/nginx/nginx.conf user nginx; worker_processes 2; #by your cpu error_log /var/log/nginx/error.log warn; pid /var/run/nginx.pid; events { worker_connections 1024; } http { include /etc/nginx/mime.">


<meta itemprop="dateModified" content="2017-09-11T10:14:51&#43;08:00" />
<meta itemprop="wordCount" content="230">



<meta itemprop="keywords" content="Nginx," />

  <link href="https://fonts.googleapis.com/css?family=Lato:400" rel="stylesheet">
  <link rel="stylesheet" href="https://twasa.github.io/css/style.css">
  <script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "WebSite",
  "name": "William&#39;s Blog",
  "url": "https://twasa.github.io/post/lnmp/"
}
</script>

</head>

<body>
  <header class="gheader">
  <div class="container">
    <nav class="navbar ">
      <div class="navbar-brand">
        <a class="navbar-item" href="https://twasa.github.io/">
          <h1 class="brand">William&#39;s Blog</h1>
        </a>

        <div class="navbar-burger burger" data-target="navMenubd-example">
          <span></span>
          <span></span>
          <span></span>
        </div>
      </div>

      <div id="navMenubd-example" class="navbar-menu">
        <div class="navbar-start">
          
          <a class="navbar-item" href="https://twasa.github.io/categories/">
            Categories
          </a>
          
          <a class="navbar-item" href="https://twasa.github.io/tags/">
            Tags
          </a>
          
        </div>
      </div>
    </nav>
  </div>
</header>


  <div class="main-content">
    <div class="container">
      
  <article class="post">
    <header class="post-header">
      <h1 class="title">CentOS7 Linux&#43;Nginx&#43;MariaDB&#43;PHP</h1>
      <div class="meta">
        <time class="pub-time"  datetime="2017-09-11T10:14:51&#43;08:00">
          2017.09.11
        </time>
        <div class="terms">
          
          <div class="categories">
            
              <a class="categories-item" href="https://twasa.github.io/categories/linux">Linux</a>
            
              <a class="categories-item" href="https://twasa.github.io/categories/webserver">Webserver</a>
            
          </div>
          
          
          <div class="tag">
            
              <a class="tag-item" href="https://twasa.github.io/tags/nginx">Nginx</a>
            
          </div>
          
        </div>
      </div>
    </header>
    <div class="post-body">
      

<h1 id="build-a-linux-nginx-mariadb-php-environment-in-centos-7">Build a Linux, Nginx, MariaDB, PHP environment in CentOS 7</h1>

<h2 id="install">install</h2>

<pre><code>rpm -Uvh http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm
yum install nginx php php-fpm mariadb mariadb-server
</code></pre>

<h2 id="firewalld-for-http-https-access-only">firewalld for http, https access only</h2>

<pre><code>firewall-cmd --zone=public --list-all
firewall-cmd --permanent --zone=public --add-service=http
firewall-cmd --permanent --zone=public --add-service=https
firewall-cmd --reload
firewall-cmd --zone=public --list-all
</code></pre>

<h2 id="nginx-config">Nginx config</h2>

<h3 id="basic-config-edit-etc-nginx-nginx-conf">basic config, edit /etc/nginx/nginx.conf</h3>

<pre><code>user  nginx;
worker_processes  2; #by your cpu

error_log  /var/log/nginx/error.log warn;
pid        /var/run/nginx.pid;

events {
    worker_connections  1024; 
}


http {
    include       /etc/nginx/mime.types;
    default_type  application/octet-stream;

    log_format  main  '$remote_addr - $remote_user [$time_local] &quot;$request&quot; '
                      '$status $body_bytes_sent &quot;$http_referer&quot; '
                      '&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;';

    access_log  /var/log/nginx/access.log  main;

    sendfile        on;
    #tcp_nopush     on;
    server_tokens   off;
    keepalive_timeout  65;

    gzip  on;
    include /etc/nginx/conf.d/*.conf;
}
</code></pre>

<h3 id="config-for-pass-the-php-scripts-to-fastcgi-server-php-fpm-using-file-socket-in-etc-nginx-conf-d-default-conf">config for pass the PHP scripts to FastCGI server php-fpm using file socket in /etc/nginx/conf.d/default.conf</h3>

<pre><code>server {
    listen       80;
    server_name  localhost;

    #charset koi8-r;
    access_log  /var/log/nginx/host.access.log  main;
    root   /usr/share/nginx/html;
    index  index.html index.php index.htm;

    location / {

    }

    error_page   500 502 503 504  /50x.html;
    location = /50x.html {
        root   /usr/share/nginx/html;
    }

    location ~ \.php$ {
        fastcgi_pass   unix:/var/run/php-fpm/php-fpm.sock;
        fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;
        include        fastcgi_params;
    }

# session path
# for mod_php, see /etc/httpd/conf.d/php.conf
# for php-fpm, see /etc/php-fpm.d/www.conf
</code></pre>

<h2 id="php-config-in-etc-php-ini">PHP config in /etc/php.ini</h2>

<pre><code>cgi.fix_pathinfo=0
</code></pre>

<h2 id="php-fpm-config-in-etc-php-fpm-d-www-conf">PHP-FPM config in /etc/php-fpm.d/www.conf</h2>

<p>listen = /var/run/php-fpm/php-fpm.sock
listen.owner = nobody
listen.group = nobody
listen.mode = 0666
user = nginx
group = nginx</p>

<h2 id="mariadb-config">MariaDB config</h2>

<p>reference to <a href="https://twasa.github.io/post/my-db/">https://twasa.github.io/post/my-db/</a></p>

<h2 id="verify">Verify</h2>

<h3 id="create-usr-share-nginx-html-info-php">create /usr/share/nginx/html/info.php</h3>

<pre><code>&lt;?php
phpinfo();
?&gt;
</code></pre>

<h2 id="web-permission-for-nginx">web permission for nginx</h2>

<pre><code>chown -R nginx:nginx /usr/share/nginx/html/
</code></pre>

<h2 id="selinux">selinux</h2>

<pre><code>chcon --reference=/usr/share/nginx/html/index.html /usr/share/nginx/html/*
</code></pre>

<h3 id="visit-http-伺服器ip-or-fqdn-info-php-to-verify">visit http://伺服器IP_or_FQDN/info.php to Verify</h3>

    </div>
    <footer class="post-footer">
      
      <div class="share">
        
      </div>

      <div class="pagenation">
        <ul class="pagenation-list">
          
          <li class="pager previous">
            <a href="https://twasa.github.io/post/python-virtualenv/" data-toggle="tooltip" data-placement="top" title="Python Virtualenv">&larr; Previous Post</a>
          </li>
          
          
          <li class="pager next">
            <a href="https://twasa.github.io/post/grep/" data-toggle="tooltip" data-placement="top" title="Grep">Next Post &rarr;</a>
          </li>
          
        </ul>
      </div>
    </footer>
  </article>

  
  <article class="related"></article>

  <script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage": {
    "@type": "NewsArticle",
    "@id": "https://twasa.github.io/post/lnmp/",
    "headline": " Build a Linux, Nginx, MariaDB, PHP environment in CentOS 7 install rpm -Uvh http://nginx.org/packages/centos/",
    "author": "William Wang",
    "publisher": {
      "@type": "Organization",
      "name": "William Wang",
      "logo": ""
    },
    "image": "",
    "datePublished": "2017-09-11"
  },
  "headline": " Build a Linux, Nginx, MariaDB, PHP environment in CentOS 7 install rpm -Uvh http://nginx.org/packages/centos/",
  "alternativeHeadline": "William&#39;s Blog",
  "datePublished": "2017-09-11",
  "dateModified": "2017-09-11",
  "url": "https://twasa.github.io/post/lnmp/",
  "wordCount": "230",
  "author": {
    "@type": "Person",
    "name": "William Wang"
  },
  "publisher": {
    "@type": "Organization",
    "name": "William Wang"
  },
  "image": "",
  "genre": "LinuxWebserver",
  "keywords": "Nginx",
  "description": ""
}
</script>

  <script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Person",
  "@id": "https://twasa.github.io/post/lnmp/",
  "name": "William Wang"
}
</script>


    </div>
  </div>

  <footer class="gfooter">
  <div class="inner">
    <div class="container">
      <p class="copy"><small>Copyright (c) 2017, all rights reserved.</small></p>

      <nav class="footer-nav">
        <div class="inner">
          
        </div>
      </nav>
    </div>
  </div>
</footer>



<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script src="https://twasa.github.io/js/script.js"></script>

</body>
</html>
